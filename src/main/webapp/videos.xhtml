<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets">
  <h:body>
    <ui:composition template="/WEB-INF/templates/frontend/main.xhtml">

      <ui:define name="title">#{videoController.getLatestPlaylist().name}</ui:define>
      <ui:param name="activeLink" value="categories.xhtml" />

      <ui:define name="extra-stylesheets">
        <h:outputStylesheet library="css/generated/frontend/grids" name="grid-videos.css" />
      </ui:define>

      <ui:define name="center-unit-1">
        <ui:include src="/WEB-INF/templates/frontend/grids/grid-videos.xhtml" />
      </ui:define>

      <ui:define name="before-closing-body">
        <script>
          /* <![CDATA[ */

          $(document).ready(function() {

            // Init video toggler
            $('.video-title').click(function() {
              var openButton = $(this).children('.button');
              var other = $('.button.open').not(openButton);

              other.parent().click();
              openButton.toggleClass('closed open');

              var content = $(this).next('dd');
              content.slideToggle('fast');

              var video = $('.video', content);
              var attributes = video.data();


              switch (attributes.videoProvider) {
                case 'YOUTUBE':
                  var element = '<iframe width="1280" height="720" src="//www.youtube-nocookie.com/embed/' + attributes.videoCode + '?rel=0" frameborder="0" allowfullscreen="allowfullscreen"></iframe>';
                  video.html($(element));
                  break;
                case 'CHANNEL9':
                  var element = '<video width="1280" height="720" controls autoplay><source src="' + attributes.videoCode + '" type="video/mp4" /></video>';
                  video.html($(element));
                  break;
                default:
                  console.warn('Provider "' + attributes.videoProvider + '" not supported.');
                  break;
              }
            });

            if (window.location.hash.length > 0) {
              $(window.location.hash).click();
            }

          });

          /* ]]> */
        </script>
      </ui:define>

    </ui:composition>
  </h:body>
</html>